.ControlPanelExpanded {
  position: fixed;
  right: calc(
    var(--control-panel-right-offset) + var(--control-panel-strip-width) +
      var(--control-panel-gap)
  );
  top: var(--control-panel-top-offset);
  z-index: var(--z-control-panel);

  container-type: inline-size;
  container-name: control-panel;

  /*
   * Mobile width: fill available space, capped at 280px
   * Available = 100vw - strip - gap - right-offset - left-margin
   */
  width: calc(100vw - (var(--control-panel-strip-width) * 2));
  max-width: 375px;

  display: flex;
  flex-direction: column;

  background: var(--color-bg-main);
  border: var(--border-size-2) solid var(--color-fg-accent);
}

/* Section wrapper for grouped rows */
.ControlPanelExpanded__section {
  display: flex;
  flex-direction: column;
  padding: var(--control-panel-padding);
}

/* Border between sections */
.ControlPanelExpanded__section + .ControlPanelExpanded__section {
  border-top: var(--border-size-2) dashed var(--color-fg-accent);
}

/* Navigation container - mobile: single column */
.ControlPanelExpanded__navigation {
  display: flex;
  flex-direction: column;
  gap: var(--control-panel-gap);
}

/* Override ControlPanelRow to stack label on top with vertical options */
.ControlPanelExpanded__navigation .ControlPanelRow {
  flex-direction: column;
  align-items: stretch;
}

.ControlPanelExpanded__navigation .ControlPanelRow__label {
  width: auto;
}

.ControlPanelExpanded__navigation .ControlPanelRow__options {
  flex-direction: column;
  max-height: 35vh;
  overflow-y: auto;

  /* Hide scrollbar but keep functionality */
  /* eslint-disable-next-line css/use-baseline */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge */
}

.ControlPanelExpanded__navigation .ControlPanelRow__options::-webkit-scrollbar {
  display: none; /* Chrome/Safari/Opera */
}

/* Routes: horizontal row on mobile */
.ControlPanelExpanded__routes .ControlPanelRow {
  flex-direction: row;
}

.ControlPanelExpanded__routes .ControlPanelRow__label {
  width: var(--control-panel-label-width);
}

.ControlPanelExpanded__routes .ControlPanelRow__options {
  flex-direction: row;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  flex-wrap: nowrap;

  /* Hide scrollbar but keep functionality */
  /* eslint-disable-next-line css/use-baseline */
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.ControlPanelExpanded__routes .ControlPanelRow__options::-webkit-scrollbar {
  display: none;
}

/* Sections: vertical scrollable list */
.ControlPanelExpanded__sections .ControlPanelRow__options {
  align-items: stretch;
}

@media (min-width: 1200px) {
  /* Navigation: two-column grid layout */
  .ControlPanelExpanded__navigation {
    display: grid;
    grid-template-columns: 30cqw minmax(0, 1fr);
    gap: calc(var(--control-panel-gap) / 2);
  }

  .ControlPanelExpanded__navigation .ControlPanelRow__options {
    max-height: 40vh;
  }

  /* Routes: inherit column layout from navigation */
  .ControlPanelExpanded__routes .ControlPanelRow {
    flex-direction: column;
  }

  .ControlPanelExpanded__routes .ControlPanelRow__label {
    width: auto;
  }

  .ControlPanelExpanded__routes .ControlPanelRow__options {
    flex-direction: column;
    overflow-x: visible;
    flex-wrap: nowrap;
  }
}
