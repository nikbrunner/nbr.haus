.GlitchEffect {
  position: relative;
  display: inline-block;
}

/* Subtle glitch - constant jitter with occasional spikes */
.GlitchEffect--subtle {
  animation:
    glitch-jitter 0.1s infinite,
    glitch-flicker 5s infinite;
}

.GlitchEffect--subtle::before,
.GlitchEffect--subtle::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  background: inherit;
  mix-blend-mode: screen;
}

.GlitchEffect--subtle::before {
  animation:
    glitch-jitter-offset 0.15s infinite,
    glitch-rgb-flare-red 5s infinite;
  box-shadow: -2px 0 0 oklch(65% 0.3 25 / 0.4);
}

.GlitchEffect--subtle::after {
  animation:
    glitch-jitter-offset 0.12s infinite reverse,
    glitch-rgb-flare-cyan 5s infinite;
  box-shadow: 2px 0 0 oklch(65% 0.25 220 / 0.4);
}

/* Medium glitch - more noticeable, periodic distortion */
.GlitchEffect--medium {
  animation: glitch-flicker 4s infinite;
}

.GlitchEffect--medium::before,
.GlitchEffect--medium::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: 0;
}

.GlitchEffect--medium::before {
  animation: glitch-medium-left 4s infinite;
  color: oklch(70% 0.25 0);
}

.GlitchEffect--medium::after {
  animation: glitch-medium-right 4s infinite;
  color: oklch(70% 0.25 220);
}

/* Strong glitch - very noticeable, constant distortion */
.GlitchEffect--strong {
  animation: glitch-flicker 2s infinite;
}

.GlitchEffect--strong::before,
.GlitchEffect--strong::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: 0;
}

.GlitchEffect--strong::before {
  animation: glitch-strong-left 2s infinite;
  color: oklch(70% 0.3 0);
}

.GlitchEffect--strong::after {
  animation: glitch-strong-right 2s infinite;
  color: oklch(70% 0.3 220);
}

/* Scanlines overlay */
.GlitchEffect--scanlines::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    oklch(0% 0 0 / 0.03) 2px,
    oklch(0% 0 0 / 0.03) 4px
  );
  pointer-events: none;
  z-index: 1;
}

/* Keyframes */

/* Base jitter - constant micro-movement */
@keyframes glitch-jitter {
  0% {
    transform: translate(0, 0);
  }
  20% {
    transform: translate(-0.5px, 0);
  }
  40% {
    transform: translate(0.5px, 0.5px);
  }
  60% {
    transform: translate(0, -0.5px);
  }
  80% {
    transform: translate(0.5px, 0);
  }
  100% {
    transform: translate(-0.5px, 0.5px);
  }
}

/* Offset jitter for pseudo-elements - creates RGB separation */
@keyframes glitch-jitter-offset {
  0% {
    opacity: 0.15;
    transform: translate(0, 0);
  }
  25% {
    opacity: 0.2;
    transform: translate(1px, 0);
  }
  50% {
    opacity: 0.1;
    transform: translate(-1px, 0.5px);
  }
  75% {
    opacity: 0.25;
    transform: translate(0.5px, -0.5px);
  }
  100% {
    opacity: 0.15;
    transform: translate(-0.5px, 0);
  }
}

@keyframes glitch-flicker {
  0%,
  100% {
    opacity: 1;
    filter: none;
  }
  20% {
    opacity: 1;
    filter: none;
  }
  21% {
    opacity: 0.85;
    filter: brightness(1.1) contrast(1.1);
  }
  22% {
    opacity: 1;
    filter: none;
  }
  70% {
    opacity: 1;
    filter: none;
  }
  71% {
    opacity: 0.9;
    filter: brightness(1.05);
  }
  72% {
    opacity: 0.8;
    filter: brightness(1.15) contrast(1.05);
  }
  73% {
    opacity: 1;
    filter: none;
  }
}

/* RGB flare keyframes - red channel */
@keyframes glitch-rgb-flare-red {
  0%,
  100% {
    opacity: 0.15;
    transform: translateX(-1px);
    box-shadow: -2px 0 0 oklch(65% 0.3 25 / 0.4);
  }
  /* First spike - RED flares */
  19% {
    opacity: 0.15;
    transform: translateX(-1px);
  }
  20% {
    opacity: 0.9;
    transform: translateX(-6px) skewX(-2deg);
    box-shadow:
      -4px 0 0 oklch(65% 0.4 25 / 0.9),
      -8px 0 0 oklch(65% 0.35 140 / 0.6);
  }
  21% {
    opacity: 0.7;
    transform: translateX(-3px) skewX(1deg);
    box-shadow:
      -3px 0 0 oklch(65% 0.35 25 / 0.7),
      -6px 0 0 oklch(65% 0.3 140 / 0.4);
  }
  23% {
    opacity: 0.15;
    transform: translateX(-1px) skewX(0);
    box-shadow: -2px 0 0 oklch(65% 0.3 25 / 0.4);
  }
  /* Second spike - RGB separation */
  69% {
    opacity: 0.15;
    transform: translateX(-1px);
  }
  70% {
    opacity: 0.85;
    transform: translateX(-5px) skewX(-1deg);
    box-shadow:
      -3px 0 0 oklch(70% 0.4 25 / 0.85),
      -7px 0 0 oklch(70% 0.35 140 / 0.7),
      -10px 0 0 oklch(60% 0.3 260 / 0.5);
  }
  72% {
    opacity: 0.5;
    transform: translateX(-2px);
    box-shadow:
      -2px 0 0 oklch(65% 0.3 25 / 0.5),
      -4px 0 0 oklch(65% 0.25 140 / 0.3);
  }
  74% {
    opacity: 0.15;
    transform: translateX(-1px) skewX(0);
    box-shadow: -2px 0 0 oklch(65% 0.3 25 / 0.4);
  }
}

/* RGB flare keyframes - cyan/blue channel */
@keyframes glitch-rgb-flare-cyan {
  0%,
  100% {
    opacity: 0.15;
    transform: translateX(1px);
    box-shadow: 2px 0 0 oklch(65% 0.25 220 / 0.4);
  }
  /* First spike - BLUE/CYAN flares */
  20% {
    opacity: 0.15;
    transform: translateX(1px);
  }
  21% {
    opacity: 0.85;
    transform: translateX(5px) skewX(2deg);
    box-shadow:
      4px 0 0 oklch(65% 0.4 220 / 0.9),
      7px 0 0 oklch(55% 0.35 280 / 0.6);
  }
  22% {
    opacity: 0.6;
    transform: translateX(3px) skewX(-1deg);
    box-shadow:
      3px 0 0 oklch(65% 0.35 220 / 0.6),
      5px 0 0 oklch(55% 0.3 280 / 0.4);
  }
  24% {
    opacity: 0.15;
    transform: translateX(1px) skewX(0);
    box-shadow: 2px 0 0 oklch(65% 0.25 220 / 0.4);
  }
  /* Second spike - full RGB */
  70% {
    opacity: 0.15;
    transform: translateX(1px);
  }
  71% {
    opacity: 0.9;
    transform: translateX(6px) skewX(1deg);
    box-shadow:
      3px 0 0 oklch(70% 0.4 220 / 0.85),
      6px 0 0 oklch(60% 0.35 280 / 0.7),
      9px 0 0 oklch(65% 0.3 25 / 0.5);
  }
  73% {
    opacity: 0.4;
    transform: translateX(2px);
    box-shadow:
      2px 0 0 oklch(65% 0.3 220 / 0.4),
      4px 0 0 oklch(55% 0.25 280 / 0.3);
  }
  75% {
    opacity: 0.15;
    transform: translateX(1px) skewX(0);
    box-shadow: 2px 0 0 oklch(65% 0.25 220 / 0.4);
  }
}

/* Medium intensity keyframes */
@keyframes glitch-medium-left {
  0%,
  100% {
    opacity: 0;
    transform: translateX(0);
  }
  45% {
    opacity: 0;
  }
  46% {
    opacity: 0.4;
    transform: translateX(-2px);
  }
  47% {
    opacity: 0;
  }
  92% {
    opacity: 0;
  }
  93% {
    opacity: 0.4;
    transform: translateX(-2px);
  }
  94% {
    opacity: 0;
  }
}

@keyframes glitch-medium-right {
  0%,
  100% {
    opacity: 0;
    transform: translateX(0);
  }
  46% {
    opacity: 0;
  }
  47% {
    opacity: 0.4;
    transform: translateX(2px);
  }
  48% {
    opacity: 0;
  }
  93% {
    opacity: 0;
  }
  94% {
    opacity: 0.4;
    transform: translateX(2px);
  }
  95% {
    opacity: 0;
  }
}

/* Strong intensity keyframes */
@keyframes glitch-strong-left {
  0%,
  100% {
    opacity: 0;
    transform: translateX(0) skewX(0);
  }
  20% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
    transform: translateX(-3px) skewX(-2deg);
  }
  22% {
    opacity: 0;
  }
  60% {
    opacity: 0;
  }
  61% {
    opacity: 0.5;
    transform: translateX(-2px) skewX(1deg);
  }
  62% {
    opacity: 0;
  }
  90% {
    opacity: 0;
  }
  91% {
    opacity: 0.6;
    transform: translateX(-4px) skewX(-1deg);
  }
  93% {
    opacity: 0;
  }
}

@keyframes glitch-strong-right {
  0%,
  100% {
    opacity: 0;
    transform: translateX(0) skewX(0);
  }
  21% {
    opacity: 0;
  }
  22% {
    opacity: 0.5;
    transform: translateX(3px) skewX(2deg);
  }
  23% {
    opacity: 0;
  }
  61% {
    opacity: 0;
  }
  62% {
    opacity: 0.5;
    transform: translateX(2px) skewX(-1deg);
  }
  63% {
    opacity: 0;
  }
  91% {
    opacity: 0;
  }
  92% {
    opacity: 0.6;
    transform: translateX(4px) skewX(1deg);
  }
  94% {
    opacity: 0;
  }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .GlitchEffect,
  .GlitchEffect::before,
  .GlitchEffect::after {
    animation: none;
  }
}
